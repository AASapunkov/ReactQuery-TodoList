{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useCallback } from 'react';\nimport axios from 'axios';\nimport { useMutation, useQueryClient } from 'react-query';\nimport { qKeyTodo, qKeyTodoList, URL } from 'src/constants';\n\nconst useRemoveTodoMutation = () => {\n  _s();\n\n  const queryClient = useQueryClient();\n  const removeMut = useCallback(async id => {\n    // eslint-disable-next-line no-useless-catch\n    try {\n      return axios.delete(`${URL}/todos/${id}`).then(res => {\n        queryClient.setQueryData(qKeyTodoList(), cacheData => {\n          const {\n            todoIdList = []\n          } = cacheData || {};\n          queryClient.removeQueries(qKeyTodo(id));\n          return {\n            todoIdList: todoIdList.filter(_id => _id !== id)\n          };\n        });\n        return res.data;\n      });\n    } catch (err) {\n      throw err;\n    }\n  }, [queryClient]);\n  const {\n    mutateAsync: remove,\n    isLoading,\n    error\n  } = useMutation(removeMut, {// onSuccess: () => queryClient.invalidateQueries(qKeyTodoList()),\n  });\n  return {\n    remove,\n    errorRemove: error,\n    isRemoving: isLoading\n  };\n};\n\n_s(useRemoveTodoMutation, \"K0gHRhOGGKU8hu3SYYqSO8KwglI=\", false, function () {\n  return [useQueryClient, useMutation];\n});\n\nexport default useRemoveTodoMutation;","map":{"version":3,"names":["useCallback","axios","useMutation","useQueryClient","qKeyTodo","qKeyTodoList","URL","useRemoveTodoMutation","queryClient","removeMut","id","delete","then","res","setQueryData","cacheData","todoIdList","removeQueries","filter","_id","data","err","mutateAsync","remove","isLoading","error","errorRemove","isRemoving"],"sources":["/Users/alexandersapunkov/Desktop/Projects/todo-react-query-presentation/src/data/mutations/useRemoveTodoMutation.js"],"sourcesContent":["import { useCallback } from 'react'\n\nimport axios from 'axios'\nimport { useMutation, useQueryClient } from 'react-query'\n\nimport { qKeyTodo, qKeyTodoList, URL } from 'src/constants'\n\nconst useRemoveTodoMutation = () => {\n  const queryClient = useQueryClient()\n\n  const removeMut = useCallback(\n    async (id) => {\n      // eslint-disable-next-line no-useless-catch\n      try {\n        return axios.delete(`${URL}/todos/${id}`).then((res) => {\n          queryClient.setQueryData(qKeyTodoList(), (cacheData) => {\n            const { todoIdList = [] } = cacheData || {}\n\n            queryClient.removeQueries(qKeyTodo(id))\n\n            return {\n              todoIdList: todoIdList.filter((_id) => _id !== id),\n            }\n          })\n\n          return res.data\n        })\n      } catch (err) {\n        throw err\n      }\n    },\n    [queryClient],\n  )\n\n  const {\n    mutateAsync: remove,\n    isLoading,\n    error,\n  } = useMutation(removeMut, {\n    // onSuccess: () => queryClient.invalidateQueries(qKeyTodoList()),\n  })\n\n  return {\n    remove,\n    errorRemove: error,\n    isRemoving: isLoading,\n  }\n}\n\nexport default useRemoveTodoMutation\n"],"mappings":";;AAAA,SAASA,WAAT,QAA4B,OAA5B;AAEA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,WAAT,EAAsBC,cAAtB,QAA4C,aAA5C;AAEA,SAASC,QAAT,EAAmBC,YAAnB,EAAiCC,GAAjC,QAA4C,eAA5C;;AAEA,MAAMC,qBAAqB,GAAG,MAAM;EAAA;;EAClC,MAAMC,WAAW,GAAGL,cAAc,EAAlC;EAEA,MAAMM,SAAS,GAAGT,WAAW,CAC3B,MAAOU,EAAP,IAAc;IACZ;IACA,IAAI;MACF,OAAOT,KAAK,CAACU,MAAN,CAAc,GAAEL,GAAI,UAASI,EAAG,EAAhC,EAAmCE,IAAnC,CAAyCC,GAAD,IAAS;QACtDL,WAAW,CAACM,YAAZ,CAAyBT,YAAY,EAArC,EAA0CU,SAAD,IAAe;UACtD,MAAM;YAAEC,UAAU,GAAG;UAAf,IAAsBD,SAAS,IAAI,EAAzC;UAEAP,WAAW,CAACS,aAAZ,CAA0Bb,QAAQ,CAACM,EAAD,CAAlC;UAEA,OAAO;YACLM,UAAU,EAAEA,UAAU,CAACE,MAAX,CAAmBC,GAAD,IAASA,GAAG,KAAKT,EAAnC;UADP,CAAP;QAGD,CARD;QAUA,OAAOG,GAAG,CAACO,IAAX;MACD,CAZM,CAAP;IAaD,CAdD,CAcE,OAAOC,GAAP,EAAY;MACZ,MAAMA,GAAN;IACD;EACF,CApB0B,EAqB3B,CAACb,WAAD,CArB2B,CAA7B;EAwBA,MAAM;IACJc,WAAW,EAAEC,MADT;IAEJC,SAFI;IAGJC;EAHI,IAIFvB,WAAW,CAACO,SAAD,EAAY,CACzB;EADyB,CAAZ,CAJf;EAQA,OAAO;IACLc,MADK;IAELG,WAAW,EAAED,KAFR;IAGLE,UAAU,EAAEH;EAHP,CAAP;AAKD,CAxCD;;GAAMjB,qB;UACgBJ,c,EA8BhBD,W;;;AAWN,eAAeK,qBAAf"},"metadata":{},"sourceType":"module"}