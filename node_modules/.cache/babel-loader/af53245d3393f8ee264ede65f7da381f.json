{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useCallback } from 'react';\nimport axios from 'axios';\nimport { useMutation, useQueryClient } from 'react-query';\nimport { qKeyTodo, qKeyTodoList, URL } from 'src/constants';\n\nconst useCreateTodoMutation = () => {\n  _s();\n\n  const queryClient = useQueryClient();\n  const createMut = useCallback(async data => {\n    // eslint-disable-next-line no-useless-catch\n    try {\n      return axios.post(`${URL}/todos`, data).then(res => {\n        const newTodo = res.data;\n        const newTodoId = newTodo.id;\n        queryClient.setQueryData(qKeyTodoList(), cacheData => {\n          const {\n            todoIdList = []\n          } = cacheData || {};\n          queryClient.setQueryData(qKeyTodo(newTodoId), newTodo);\n          return {\n            todoIdList: [...todoIdList, newTodoId]\n          };\n        });\n        return newTodo;\n      });\n    } catch (err) {\n      throw err;\n    }\n  }, [queryClient]);\n  const {\n    mutateAsync: create,\n    isLoading,\n    error\n  } = useMutation(createMut, {// onSuccess: () => queryClient.invalidateQueries(qKeyTodoList()),\n  });\n  return {\n    create,\n    errorCreate: error,\n    isCreating: isLoading\n  };\n};\n\n_s(useCreateTodoMutation, \"CJNrNMDAIDVBC1qUwpUNSDAFsDY=\", false, function () {\n  return [useQueryClient, useMutation];\n});\n\nexport default useCreateTodoMutation;","map":{"version":3,"names":["useCallback","axios","useMutation","useQueryClient","qKeyTodo","qKeyTodoList","URL","useCreateTodoMutation","queryClient","createMut","data","post","then","res","newTodo","newTodoId","id","setQueryData","cacheData","todoIdList","err","mutateAsync","create","isLoading","error","errorCreate","isCreating"],"sources":["/Users/alexandersapunkov/Desktop/Projects/todo-react-query-presentation/src/data/mutations/useCreateTodoMutation.js"],"sourcesContent":["import { useCallback } from 'react'\n\nimport axios from 'axios'\nimport { useMutation, useQueryClient } from 'react-query'\n\nimport { qKeyTodo, qKeyTodoList, URL } from 'src/constants'\n\nconst useCreateTodoMutation = () => {\n  const queryClient = useQueryClient()\n\n  const createMut = useCallback(\n    async (data) => {\n      // eslint-disable-next-line no-useless-catch\n      try {\n        return axios.post(`${URL}/todos`, data).then((res) => {\n          const newTodo = res.data\n          const newTodoId = newTodo.id\n\n          queryClient.setQueryData(qKeyTodoList(), (cacheData) => {\n            const { todoIdList = [] } = cacheData || {}\n\n            queryClient.setQueryData(qKeyTodo(newTodoId), newTodo)\n\n            return { todoIdList: [...todoIdList, newTodoId] }\n          })\n\n          return newTodo\n        })\n      } catch (err) {\n        throw err\n      }\n    },\n    [queryClient],\n  )\n\n  const {\n    mutateAsync: create,\n    isLoading,\n    error,\n  } = useMutation(createMut, {\n    // onSuccess: () => queryClient.invalidateQueries(qKeyTodoList()),\n  })\n\n  return {\n    create,\n    errorCreate: error,\n    isCreating: isLoading,\n  }\n}\n\nexport default useCreateTodoMutation\n"],"mappings":";;AAAA,SAASA,WAAT,QAA4B,OAA5B;AAEA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,WAAT,EAAsBC,cAAtB,QAA4C,aAA5C;AAEA,SAASC,QAAT,EAAmBC,YAAnB,EAAiCC,GAAjC,QAA4C,eAA5C;;AAEA,MAAMC,qBAAqB,GAAG,MAAM;EAAA;;EAClC,MAAMC,WAAW,GAAGL,cAAc,EAAlC;EAEA,MAAMM,SAAS,GAAGT,WAAW,CAC3B,MAAOU,IAAP,IAAgB;IACd;IACA,IAAI;MACF,OAAOT,KAAK,CAACU,IAAN,CAAY,GAAEL,GAAI,QAAlB,EAA2BI,IAA3B,EAAiCE,IAAjC,CAAuCC,GAAD,IAAS;QACpD,MAAMC,OAAO,GAAGD,GAAG,CAACH,IAApB;QACA,MAAMK,SAAS,GAAGD,OAAO,CAACE,EAA1B;QAEAR,WAAW,CAACS,YAAZ,CAAyBZ,YAAY,EAArC,EAA0Ca,SAAD,IAAe;UACtD,MAAM;YAAEC,UAAU,GAAG;UAAf,IAAsBD,SAAS,IAAI,EAAzC;UAEAV,WAAW,CAACS,YAAZ,CAAyBb,QAAQ,CAACW,SAAD,CAAjC,EAA8CD,OAA9C;UAEA,OAAO;YAAEK,UAAU,EAAE,CAAC,GAAGA,UAAJ,EAAgBJ,SAAhB;UAAd,CAAP;QACD,CAND;QAQA,OAAOD,OAAP;MACD,CAbM,CAAP;IAcD,CAfD,CAeE,OAAOM,GAAP,EAAY;MACZ,MAAMA,GAAN;IACD;EACF,CArB0B,EAsB3B,CAACZ,WAAD,CAtB2B,CAA7B;EAyBA,MAAM;IACJa,WAAW,EAAEC,MADT;IAEJC,SAFI;IAGJC;EAHI,IAIFtB,WAAW,CAACO,SAAD,EAAY,CACzB;EADyB,CAAZ,CAJf;EAQA,OAAO;IACLa,MADK;IAELG,WAAW,EAAED,KAFR;IAGLE,UAAU,EAAEH;EAHP,CAAP;AAKD,CAzCD;;GAAMhB,qB;UACgBJ,c,EA+BhBD,W;;;AAWN,eAAeK,qBAAf"},"metadata":{},"sourceType":"module"}